require 'lib/Function.rb'
require 'lib/InstructionFilter.rb'

class ExploitPotentialEvaluator

  def initialize( filter )
    @filter_class = filter
    @functions = Set.new
  end

  def addFunctions( functions )
    @functions.merge( functions )
  end

  def applyFilters
    @functions.each do |function|
      function.applyFilter( @filter_class )
    end
  end

  def applyGadgets( gadgets )
    @functions.each do |function|
      function.gadgets = gadgets.reject { |g| !function.filter.allows?( g ) }
    end
  end

end
